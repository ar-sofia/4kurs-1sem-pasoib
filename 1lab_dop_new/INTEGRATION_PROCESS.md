# –°—Ö–µ–º–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä –≤ ClamAV

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä

```
1. YARA –ü—Ä–∞–≤–∏–ª–æ (–∏—Å—Ö–æ–¥–Ω–æ–µ)
   ‚Üì
   rule Signatures_PS1 {
       strings:
           $sig1 = "Virus_INFECTED" ascii
           $sig2 = "Set-Content -Path" ascii
           $sig3 = "File infected:" ascii
       condition: all of them
   }
   ‚Üì

2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ ClamAV —Ñ–æ—Ä–º–∞—Ç (.ndb)
   ‚Üì
   virus.prototype.ps1:0:*:56697275735f494e464543544544
   ‚Üì
   [–∏–º—è]:[—Å–º–µ—â–µ–Ω–∏–µ]:[—Ç–∏–ø]:[HEX_—Å—Ç—Ä–æ–∫–∞]

3. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
   ‚Üì
   ./signatures/virus_prototype_ps1.ndb
   ‚Üì
   /var/lib/clamav/signatures/virus_prototype_ps1.ndb
   ‚Üì
   /var/lib/clamav/virus_prototype_ps1.ndb  ‚Üê –í–ê–ñ–ù–û: –æ—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è!

4. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ ClamAV –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä
   ‚Üì
   sudo docker-compose restart

5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
   ‚Üì
   sudo docker exec clamav clamscan /scan/disk-monitor.ps1
   ‚Üì
   –†–µ–∑—É–ª—å—Ç–∞—Ç: virus.prototype.ps1.UNOFFICIAL FOUND
```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ClamAV —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –≤–∏—Ä—É—Å –ø–æ –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–µ
- –°–∏–≥–Ω–∞—Ç—É—Ä–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –≤ `/var/lib/clamav/virus_prototype_ps1.ndb`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `clamscan` (–Ω–µ `clamdscan`) –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏:
1. **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä:** –¢–æ–ª—å–∫–æ –≤ `/var/lib/clamav/`, –Ω–µ –≤ –ø–æ–¥–ø–∞–ø–∫–∞—Ö
2. **–§–æ—Ä–º–∞—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä:** .ndb (–Ω–µ .yar –¥–ª—è ClamAV)
3. **HEX –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –°—Ç—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ HEX —Ñ–æ—Ä–º–∞—Ç–µ
4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:** –û–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```
HEX –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:
"Virus_INFECTED" ‚Üí "56697275735f494e464543544544"

–§–æ—Ä–º–∞—Ç .ndb:
virus.prototype.ps1:0:*:56697275735f494e464543544544
‚îÇ                    ‚îÇ ‚îÇ  ‚îÇ
‚îÇ                    ‚îÇ ‚îÇ  ‚îî‚îÄ HEX —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
‚îÇ                    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ –¢–∏–ø —Ñ–∞–π–ª–∞ (* = –ª—é–±–æ–π)
‚îÇ                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–º–µ—â–µ–Ω–∏–µ (0 = –≤ –ª—é–±–æ–º –º–µ—Å—Ç–µ)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ò–º—è –≤–∏—Ä—É—Å–∞
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```
–ë—ã–ª–æ:  ClamAV –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç virus.prototype.ps1
–°—Ç–∞–ª–æ: ClamAV —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç virus.prototype.ps1.UNOFFICIAL

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏  
‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```
