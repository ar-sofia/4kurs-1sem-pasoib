# ClamAV Docker Deployment

–ü—Ä–æ—Å—Ç–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è ClamAV –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ó–∞–ø—É—Å–∫ ClamAV
./start.sh

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
./test.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏—Ä—É—Å–∞
./check-virus.sh
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
1lab_dop_new/
‚îú‚îÄ‚îÄ docker-compose.yml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ clamd.conf                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ClamAV daemon
‚îÇ   ‚îî‚îÄ‚îÄ freshclam.conf             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑
‚îú‚îÄ‚îÄ signatures/
‚îÇ   ‚îú‚îÄ‚îÄ virus_prototype_ps1.yar    # YARA —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)
‚îÇ   ‚îî‚îÄ‚îÄ virus_prototype_ps1.ndb    # ClamAV HEX —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
‚îú‚îÄ‚îÄ scan/                          # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ disk-monitor.ps1          # –ó–∞—Ä–∞–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ quarantine/                    # –ö–∞—Ä–∞–Ω—Ç–∏–Ω –¥–ª—è –∑–∞—Ä–∞–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ start.sh                      # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ test.sh                       # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ check-virus.sh                # –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∏—Ä—É—Å–∞
‚îî‚îÄ‚îÄ README.md                     # –î–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
sudo docker exec clamav clamscan /scan/your_file.txt

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
sudo docker exec clamav clamscan -v /scan/your_file.txt

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
sudo docker exec clamav clamscan /scan/
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo docker-compose restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo docker-compose logs -f clamav
```

## üéØ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞—Ç—É—Ä

### YARA –ø—Ä–∞–≤–∏–ª–æ:
```yara
rule Signatures_PS1 {
    strings:
        $sig1 = "Virus_INFECTED" ascii
        $sig2 = "Set-Content -Path" ascii
        $sig3 = "File infected:" ascii
        
    condition:
        all of them
}
```

### ClamAV HEX —Å–∏–≥–Ω–∞—Ç—É—Ä–∞:
```
virus.prototype.ps1:0:*:56697275735f494e464543544544
```

**–ì–¥–µ:** `56697275735f494e464543544544` = HEX –¥–ª—è "Virus_INFECTED"

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ:
```
üéØ –†–ï–ó–£–õ–¨–¢–ê–¢: –í–ò–†–£–° –û–ë–ù–ê–†–£–ñ–ï–ù!
   –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞, —Ç–∞–∫ –∫–∞–∫ clamav –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –∏ –ø–æ–º–µ—á–∞–µ—Ç —Ñ–∞–π–ª –∫–∞–∫ –∑–∞—Ä–∞–∂–µ–Ω–Ω—ã–π
   –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç virus.prototype.ps1

üîç –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ClamAV:
/scan/disk-monitor.ps1: virus.prototype.ps1.UNOFFICIAL FOUND
```

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

- **ClamAV daemon**: `localhost:3311` (–≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç 3311 ‚Üí –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π 3310)

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ClamAV](https://docs.clamav.net/)
- [Docker Hub - ClamAV](https://hub.docker.com/r/clamav/clamav)
- [GitHub - ClamAV](https://github.com/Cisco-Talos/clamav)